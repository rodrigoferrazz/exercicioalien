<!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Exercício do Alien</title>
            <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
            <style> body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; } </style>
        </head>
        
        <body>
            <script>
                // Define as dimensões do jogo
                const larguraJogo = 700;
                const alturaJogo = 850;
                
                // seta as configurações essenciais do jogo
                const config = {
                    
                    type: Phaser.AUTO,
                    width: larguraJogo,
                    height: alturaJogo,

                    physics: {
                        default: 'arcade',
                        arcade: { gravity: {y: 300}, debug: true }
                    },

                    scene: {
                        preload: preload,
                        create: create,
                        update: update
                    }
                }

                // Criando variáveis para usar no jogo, ou seja, todos os objetos estão criados aqui
                const game = new Phaser.Game(config)
                
                var alien
                var teclado;
                var fogo;
                var plataforma;
                var moeda;
                var pontuacao = 0;
                var placar;

                function preload() {
                    // Carregando as imagens do jogo
                    this.load.image('bg', 'assets/bg.png')
                    this.load.image('alien', 'assets/alienigena.png')
                    this.load.image('turbo', 'assets/turbo.png')
                    this.load.image('plataforma', 'assets/tijolos.png')
                    this.load.image('moeda', 'assets/moeda.png')
                }
                function create() {
                    // Adicionando as imagens e sprites carregadas acima e definindo as dimensões (também dando valor as variáveis)
                    this.add.image(350, 425, 'bg')
                    turbo = this.add.sprite(0, 0, 'turbo')
                    alien = this.physics.add.sprite(200, 300, 'alien')

                    turbo.setVisible(false)

                    alien.setCollideWorldBounds(true)
                    alien.body.setSize(120, 100, true)
                    
                    // Definindo teclas para o jogo
                    teclado = this.input.keyboard.createCursorKeys()

                    // Dando valor e física para a imagem tijolos, que são as plataformas
                    plataforma = this.physics.add.staticImage(larguraJogo/2, alturaJogo/2, 'plataforma')
                    this.physics.add.collider(alien, plataforma)
                    plataforma = this.physics.add.staticImage(240, 250, 'plataforma')
                    this.physics.add.collider(alien, plataforma)

                    // Criando todo o sistema de moedas, desaparecendo e aparecendo na tela quando o player passa por cima
                    moeda = this.physics.add.sprite(larguraJogo/2, 0, 'moeda');
                    moeda.setCollideWorldBounds(true);
                    moeda.setBounce(0.7);
                    this.physics.add.collider(moeda, plataforma);

                    placar = this.add.text(50, 50, 'Moedas:' + pontuacao, {fontSize:'45px', fill:'#495613'});

                    this.physics.add.overlap(alien, moeda, function() {
                    
                    moeda.setVisible(false); //moeda desaparece
                    var posicaoMoeda_Y = Phaser.Math.RND.between(50, 650); //define número
                    moeda.setPosition(posicaoMoeda_Y, 100); // coloca a moeda na posicao correta
                    pontuacao +=1; // soma pontuacao no placar
                    placar.setText('Moedas:' + pontuacao); //aparece a pontuacao atualizada
                    moeda.setVisible(true); // aparece outra moeda
    
                });
            }
                function update() {
                    // Implementando os movimentos, velocidade e quando a gravidade irá agir 
                    if (teclado.left.isDown) {
                        alien.setVelocityX(-300);
                        ativarTurbo();
                    }

                    // Movimento para direita [ -> ]
                    else if (teclado.right.isDown) {
                        alien.setVelocityX(300);
                        ativarTurbo();
                    }

                    // Sem movimento horizontal [ x = 0 ]
                    else {
                        alien.setVelocityX(0);
                        semTurbo();
                    }

                    // Movimento para cima [ ^ ]
                    if (teclado.up.isDown) {
                        alien.setVelocityY(-230);
                        ativarTurbo();
                    }
                
                    // Movimento para baixo [ gravidade em y]
                    if (teclado.down.isDown){
                        alien.setVelocityY(300)
                        ativarTurbo();
                        // ação da gravidade do jogo em y
                    }
                    turbo.setPosition(alien.x, alien.y + alien.height/2);
                }
                // Funções para aparecer e desaparecer o fogo no alien
                function ativarTurbo() {
                    turbo.setVisible(true);
                }
                function semTurbo() {
                    turbo.setVisible(false);
                }
            </script>    
        </body>
    </html>